/*
 *  Filename	: ExploitInfo.h
 *  Author		: Kuba Sejdak
 *  Created on	: 03-05-2012
 */

#ifndef EXPLOITINFO_H_
#define EXPLOITINFO_H_

#include <QMultiMap>
#include <QMap>
#include <QList>
#include <QString>
#include <QtSql>
#include <stdint.h>
#include <iostream>
#include <iomanip>
using namespace std;

typedef QMap<QString, QString> TraitsEntry;
typedef QMultiMap<QString, TraitsEntry *> TraitsMap;

class ExploitInfo {
public:
	ExploitInfo();
	~ExploitInfo();

	void printInfo();

    QString name();
    QString extractedFrom();
    QString graphName();
	int size();
    QString fileType();
	int fileSize();
    int codeOffset();
	bool isExploitPresent();
	TraitsMap *traits();
    QList<QSqlQuery> *querys();
	bool isBroken();

    void setName(QString name);
    void setExtractedFrom(QString name);
    void setGraphName(QString name);
	void setSize(int size);
    void setFileType(QString fileType);
	void setFileSize(int fileSize);
	void setCodeOffset(int codeOffset);
	void setExploitPresent(bool exploitPresent);
	void setTrait(QString name, TraitsEntry *value);
	void setQuery(QSqlQuery q);
	void setBroken(bool broken);

private:
    QString m_name;
    QString m_extractedFrom;
    QString m_graphName;
	int m_size;
    QString m_fileType;
	int m_fileSize;
	int m_codeOffset;
	bool m_exploitPresent;
	TraitsMap *m_traits;
    QList<QSqlQuery> *m_querys;
	bool m_broken;
};

#endif /* EXPLOITINFO_H_ */
