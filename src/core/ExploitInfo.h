/*
 *  Filename	: ExploitInfo.h
 *  Author		: Kuba Sejdak
 *  Created on	: 03-05-2012
 */

#ifndef EXPLOITINFO_H_
#define EXPLOITINFO_H_

#include <list>
#include <string>
#include <memory>
#include <QDate>
#include <QMap>
#include <QMultiMap>

typedef QMap<std::string, std::string> TraitEntry;
typedef std::shared_ptr<TraitEntry> TraitEntryHandle;
typedef QMultiMap<std::string, TraitEntryHandle> TraitMap;
typedef std::shared_ptr<TraitMap> TraitMapHandle ;

class ExploitInfo {
public:
	ExploitInfo();
	~ExploitInfo() {}

	std::string name();
	std::string extractedFrom();
	std::string graphName();
	QDate captureDate();
	int size();
	std::string fileType();
	int fileSize();
    int codeOffset();
	bool isExploitPresent();
	TraitMapHandle  traits();
	bool isBroken();

	void setName(std::string name);
	void setExtractedFrom(std::string name);
	void setGraphName(std::string name);
	void setSize(int size);
	void setFileType(std::string fileType);
	void setFileSize(int fileSize);
	void setCodeOffset(int codeOffset);
	void setTrait(std::string name, TraitEntryHandle value);

private:
	std::string m_name;
	std::string m_extractedFrom;
	std::string m_graphName;
	QDate m_captureDate;
	int m_size;
	std::string m_fileType;
	int m_fileSize;
	int m_codeOffset;
	TraitMapHandle  m_traits;
};

typedef std::shared_ptr<ExploitInfo> ExploitInfoHandle;

#endif /* EXPLOITINFO_H_ */
