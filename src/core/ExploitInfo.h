/*
 *  Filename	: ExploitInfo.h
 *  Author		: Kuba Sejdak
 *  Created on	: 03-05-2012
 */

#ifndef EXPLOITINFO_H_
#define EXPLOITINFO_H_

class QMultiMap;
class QMap;
class QList;
class QDate;
class QString;
class QSqlQuery;

typedef QMap<QString, QString> TraitsEntry;
typedef QMultiMap<QString, TraitsEntry *> TraitsMap;

class ExploitInfo {
public:
	ExploitInfo();
	~ExploitInfo();

    QString name();
    QString extractedFrom();
    QString graphName();
	QDate captureDate();
	int size();
    QString fileType();
	int fileSize();
    int codeOffset();
	bool isExploitPresent();
	TraitsMap *traits();
    QList<QSqlQuery> *querys();
	bool isBroken();

    void setName(QString name);
    void setExtractedFrom(QString name);
    void setGraphName(QString name);
	void setSize(int size);
    void setFileType(QString fileType);
	void setFileSize(int fileSize);
	void setCodeOffset(int codeOffset);
	void setTrait(QString name, TraitsEntry *value);
	void setQuery(QSqlQuery q);

private:
    QString m_name;
    QString m_extractedFrom;
    QString m_graphName;
	QDate m_captureDate;
	int m_size;
    QString m_fileType;
	int m_fileSize;
	int m_codeOffset;
	TraitsMap *m_traits;
    QList<QSqlQuery> *m_querys;
};

#endif /* EXPLOITINFO_H_ */
