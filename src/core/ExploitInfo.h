/*
 *  Filename	: ExploitInfo.h
 *  Author		: Kuba Sejdak
 *  Created on	: 03-05-2012
 */

#ifndef EXPLOITINFO_H_
#define EXPLOITINFO_H_

#include <list>
#include <string>
#include <QDate>
#include <QSqlQuery>
#include <QMap>
#include <QMultiMap>

typedef QMap<std::string, std::string> TraitsEntry;
typedef QMultiMap<std::string, TraitsEntry *> TraitsMap;

class ExploitInfo {
public:
	ExploitInfo();
	~ExploitInfo();

	std::string name();
	std::string extractedFrom();
	std::string graphName();
	QDate captureDate();
	int size();
	std::string fileType();
	int fileSize();
    int codeOffset();
	bool isExploitPresent();
	TraitsMap *traits();
	std::list<QSqlQuery> *querys();
	bool isBroken();

	void setName(std::string name);
	void setExtractedFrom(std::string name);
	void setGraphName(std::string name);
	void setSize(int size);
	void setFileType(std::string fileType);
	void setFileSize(int fileSize);
	void setCodeOffset(int codeOffset);
	void setTrait(std::string name, TraitsEntry *value);
	void setQuery(QSqlQuery q);

private:
	std::string m_name;
	std::string m_extractedFrom;
	std::string m_graphName;
	QDate m_captureDate;
	int m_size;
	std::string m_fileType;
	int m_fileSize;
	int m_codeOffset;
	TraitsMap *m_traits;
	std::list<QSqlQuery> *m_querys;
};

#endif /* EXPLOITINFO_H_ */
